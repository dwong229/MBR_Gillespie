function [notinbox] = is_point_in_box(boxcorners,point)

% Given a box and a set of xy coordinates for point, return a vector inbox
% storing 1 if the point is in the box and 0 if the point is not in the box
% 
% INPUT
% define box by bottom left and top right corner SIZE = [2,2] = [x1,y1;x2,y2]
% point SIZE = [n,2] = [x y]
%
% OUTPUT
% inbox SIZE = [n,2]

numpt = length(point);

inbox = zeros(1,numpt);

xmin = min(boxcorners(:,1));
ymin = min(boxcorners(:,2));
xmax = max(boxcorners(:,1));
ymax = max(boxcorners(:,2));

% return 1 if beyond limits
xyCheck = zeros(numpt,4);
xyCheck(:,1) = bsxfun(@lt,point(:,1),xmin);
xyCheck(:,2) = bsxfun(@gt,point(:,1),xmax);
xyCheck(:,3) = bsxfun(@lt,point(:,2),ymin);
xyCheck(:,4) = bsxfun(@gt,point(:,2),ymax);

notinbox = max(xyCheck,[],2); %search each row and save max value
